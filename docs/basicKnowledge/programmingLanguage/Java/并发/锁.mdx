---
sidebar_position: 4
---

> 是对资源的访问控制，本身也是一个对象
## Synchronized
> 对象锁，悲观锁
### 作用
* [可见性，清空工作区内存，同步主内存](/docs/basicKnowledge/programmingLanguage/Java/并发/基本概念#lock-monitor)
* 有序性，原子性：同一时刻只允许一条线程访问资源，知道方法或代码块结束
### 使用和原理
* 对于非静态成员函数，锁加在对象上面的（方法上的访问标志）
* 对于静态成员函数，锁是加在class对象上（方法上的访问标志）
* 对于代码块加锁，加到特定对象（monitorenter,monitorexit）
* 综上，synchronized是在对象头的Mark Word区，存2个重要字段：锁标志位和占用该锁的thread ID
### Q&A
### 优化
锁可以升级但是不能降级
#### 前置知识：对象头
#### 偏向锁
> 为了在无竞争状态下，让同一线程更快获取到锁
##### 获取流程
* 首先获取锁 对象的 MarkWord，判断是否处于可偏向状态
  * 如果是可偏向状态，则通过 CAS 操作，把当前线程的 ID 写入到 MarkWord
    * 如果 cas 成功， 表示已经获得了锁对象的偏向锁，接着执行同步代码块
    * 如果 cas 失败，说明有其他线程已经获得了偏向锁，当前锁存在竞争，需要撤销已获得偏向锁的线程，并升级为轻量级锁
  * 如果是已偏向状态，需要检查当前线程是不是记录线程（ MarkWord 中存储的ThreadID 是否等于当前线程的 ThreadID）
    * 如果相等，不需要再次获得锁（加锁，解锁，更新MarkWord），可直接执行同步代码块
    * 如果不相等，说明当前锁偏向于其他线程，需要撤销偏向锁并升级到轻量级锁
#### 轻量级锁
#### 重量级锁

## Lock
## 一些具体的类
## 一些分类 

